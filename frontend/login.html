<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Login - APK Store</title>
<link rel="stylesheet" href="/style.css">

<!-- PWA -->
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#2196f3">

<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js').then(()=> console.log('SW registered (login)')).catch(()=>{});
}
</script>
</head>
<body>
<main style="max-width:420px;margin:90px auto;padding:120px;background:rgba(255,255,255,0.03);border-radius:8px">
  &nbsp  <h1 align="center">Login</h1>
  <div style="margin-bottom:12px">
    <input id="username" placeholder="Username" />
  </div>
  <div style="margin-bottom:12px">
    <input id="password" type="password" placeholder="Password" />
  </div>
 <p align="center"> <button id="loginBtn" class="btn"  >Login</button></p>
  <p id="loginMsg" class="msg"></p>
  
</main>

<script>
document.getElementById("loginBtn").addEventListener("click", async () => {
  const u = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value.trim();
  if (!u || !p) { document.getElementById("loginMsg").textContent = "Fill both"; return; }
  const res = await fetch("/login", { method: "POST", headers: {"Content-Type":"application/json"}, body: JSON.stringify({ username: u, password: p }) });
  const j = await res.json();
  if (j.success) {
    // store locally for simple session (backend in this simple project does not have sessions)
    localStorage.setItem("apk_user", JSON.stringify({ username: j.username, role: j.role }));
    window.location.href = "index.html";
  } else {
    document.getElementById("loginMsg").textContent = j.message || "Login failed";
  }
});
</script>
</body>
</html>
